var D=(k,_,s)=>new Promise((v,c)=>{var x=u=>{try{y(s.next(u))}catch(g){c(g)}},C=u=>{try{y(s.throw(u))}catch(g){c(g)}},y=u=>u.done?v(u.value):Promise.resolve(u.value).then(x,C);y((s=s.apply(k,_)).next())});import{m as T,r as b,c as V,b as m,d as e,e as i,w as r,u as l,F as R,f as $,T as z,o as p,_ as f,i as d,B as w,t as o,g as S,D as E,j as P}from"./index.js";import{B as j}from"./Badge.js";const M={class:"p-8 max-w-7xl mx-auto relative"},O={class:"flex justify-between items-center mb-6"},A={class:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden"},L={class:"w-full text-left text-sm"},U={class:"divide-y divide-gray-100"},G={key:0},J={key:1},q=["onClick"],H={class:"px-6 py-4"},K={class:"font-medium text-gray-900 group-hover:text-[#4318FF] transition-colors"},Q={class:"text-xs text-gray-400 mt-0.5"},W={class:"px-6 py-4"},X={class:"px-6 py-4"},Y={class:"text-gray-900"},Z={class:"text-gray-500 mt-0.5"},ee={class:"px-6 py-4 text-gray-600"},te={key:0,class:"mt-6 space-y-6"},se={class:"flex items-start justify-between border-b border-gray-100 pb-6"},ae={class:"flex gap-4"},oe={class:"h-16 w-16 rounded-full bg-[#4318FF]/10 flex items-center justify-center text-2xl font-bold text-[#4318FF]"},ne={class:"text-2xl font-bold text-gray-900"},le={class:"text-gray-500"},ie={class:"mt-2"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},de={class:"space-y-1"},ce={class:"flex items-center gap-2 text-gray-700"},ue={class:"flex items-center gap-2 text-gray-700"},me={class:"space-y-1"},pe={class:"flex items-center gap-2 text-gray-700"},_e={class:"flex items-center gap-2 text-gray-700"},ge={class:"bg-gray-50 p-4 rounded-lg flex items-center justify-between mt-4"},fe={class:"text-sm text-gray-600"},xe={key:0},ve={key:1,class:"text-red-500"},ye={key:0,class:"fixed bottom-6 right-6 z-50 flex items-center gap-3 px-4 py-3 bg-white rounded-lg shadow-lg border border-gray-100 max-w-sm"},he={class:"text-sm font-semibold text-gray-900"},be={class:"text-xs text-gray-500"},we={__name:"Contacts",setup(k){const _=b(!1),s=b(null),v=b(!1),c=b({show:!1,title:"",message:"",type:"success"}),x=V({url:"frappe.client.get_list",params:{doctype:"Contact",fields:["name","first_name","last_name","salutation","email_id","mobile_no","phone","status","designation","company_name","gender"],order_by:"creation desc",limit:50},auto:!0});function C(){window.open("/app/contact/new","_blank")}function y(n){s.value=n,_.value=!0}function u(){s.value&&window.open(`/app/contact/${s.value.name}`,"_blank")}function g(n,t,a="success"){c.value={show:!0,title:n,message:t,type:a},setTimeout(()=>{c.value.show=!1},4e3)}function I(){return D(this,null,function*(){const n=s.value,t=h(n);if(!t){g("Missing Info","No phone number found for this contact.","error");return}v.value=!0;try{const a=yield fetch("/api/method/ai_calling_agent.api.start_ai_call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_number:`${t}`,contact_docname:n.name})}),N=yield a.json();if(a.ok)g("Call Initiated","Connecting agent...","success"),_.value=!1;else throw new Error(N.message||"Server Error")}catch(a){console.error(a),g("Error",`Failed to start call: ${a.message}`,"error")}finally{v.value=!1}})}function h(n){return n.mobile_no||n.phone||null}function F(n){return n==="Open"?"green":n==="Replied"?"blue":n==="Passive"?"orange":"gray"}function B(n){const t=n.first_name?n.first_name[0]:"",a=n.last_name?n.last_name[0]:"";return(t+a).toUpperCase()}return(n,t)=>(p(),m("div",M,[e("div",O,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Contacts"),e("p",{class:"text-sm text-gray-500 mt-1"},"Synced with Frappe CRM")],-1)),i(l(w),{variant:"solid",size:"md",class:"!bg-[#4318FF] hover:!bg-[#3311CC] !text-white border-transparent",onClick:C},{prefix:r(()=>[i(l(f),{name:"plus",class:"h-4 w-4"})]),default:r(()=>[t[2]||(t[2]=d(" Add Contact (CRM) ",-1))]),_:1})]),e("div",A,[e("table",L,[t[6]||(t[6]=e("thead",{class:"bg-gray-50 border-b border-gray-200 text-gray-500 font-medium"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Name & Designation"),e("th",{class:"px-6 py-3"},"Status"),e("th",{class:"px-6 py-3"},"Contact Info"),e("th",{class:"px-6 py-3"},"Company")])],-1)),e("tbody",U,[l(x).loading?(p(),m("tr",G,[...t[4]||(t[4]=[e("td",{colspan:"4",class:"p-6 text-center text-gray-500"}," Loading contacts... ",-1)])])):!l(x).data||l(x).data.length===0?(p(),m("tr",J,[...t[5]||(t[5]=[e("td",{colspan:"4",class:"p-6 text-center text-gray-500"}," No contacts found. ",-1)])])):(p(!0),m(R,{key:2},$(l(x).data,a=>(p(),m("tr",{key:a.name,onClick:N=>y(a),class:"hover:bg-gray-50 transition-colors cursor-pointer group"},[e("td",H,[e("div",K,o(a.first_name)+" "+o(a.last_name),1),e("div",Q,o(a.designation||"No Designation"),1)]),e("td",W,[i(l(j),{theme:F(a.status)},{default:r(()=>[d(o(a.status),1)]),_:2},1032,["theme"])]),e("td",X,[e("div",Y,o(a.email_id||"-"),1),e("div",Z,o(a.mobile_no||a.phone||"-"),1)]),e("td",ee,o(a.company_name||"-"),1)],8,q))),128))])])]),i(l(E),{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=a=>_.value=a),options:{size:"xl"}},{"body-title":r(()=>[...t[7]||(t[7]=[e("h3",{class:"text-xl font-bold"},"Contact Details",-1)])]),"body-content":r(()=>[s.value?(p(),m("div",te,[e("div",se,[e("div",ae,[e("div",oe,o(B(s.value)),1),e("div",null,[e("h2",ne,o(s.value.salutation?s.value.salutation+" ":"")+" "+o(s.value.first_name)+" "+o(s.value.last_name),1),e("div",le,o(s.value.designation),1),e("div",ie,[i(l(j),{theme:F(s.value.status),size:"lg"},{default:r(()=>[d(o(s.value.status),1)]),_:1},8,["theme"])])])])]),e("div",re,[e("div",de,[t[8]||(t[8]=e("div",{class:"text-xs font-semibold text-gray-500 uppercase"}," Contact Info ",-1)),e("div",ce,[i(l(f),{name:"mail",class:"h-4 w-4 text-[#4318FF]"}),d(" "+o(s.value.email_id||"No Email"),1)]),e("div",ue,[i(l(f),{name:"phone",class:"h-4 w-4 text-[#4318FF]"}),d(" "+o(s.value.mobile_no||s.value.phone||"No Phone"),1)])]),e("div",me,[t[9]||(t[9]=e("div",{class:"text-xs font-semibold text-gray-500 uppercase"}," Professional ",-1)),e("div",pe,[i(l(f),{name:"briefcase",class:"h-4 w-4 text-[#4318FF]"}),d(" "+o(s.value.company_name||"No Company"),1)]),e("div",_e,[i(l(f),{name:"user",class:"h-4 w-4 text-[#4318FF]"}),d(" "+o(s.value.gender||"Gender Not Specified"),1)])])]),e("div",ge,[e("div",fe,[h(s.value)?(p(),m("span",xe,[t[10]||(t[10]=d(" Ready to call ",-1)),e("strong",null,o(h(s.value)),1)])):(p(),m("span",ve,"No phone number available."))]),i(l(w),{variant:"solid",class:"!bg-[#4318FF] hover:!bg-[#3311CC] !text-white border-transparent",loading:v.value,disabled:!h(s.value),onClick:I},{prefix:r(()=>[i(l(f),{name:"phone-call",class:"h-4 w-4"})]),default:r(()=>[t[11]||(t[11]=d(" Start AI Call ",-1))]),_:1},8,["loading","disabled"])])])):S("",!0)]),actions:r(()=>[i(l(w),{variant:"subtle",onClick:t[0]||(t[0]=a=>_.value=!1)},{default:r(()=>[...t[12]||(t[12]=[d("Close",-1)])]),_:1}),i(l(w),{variant:"outline",onClick:u},{default:r(()=>[...t[13]||(t[13]=[d("Open in Desk",-1)])]),_:1})]),_:1},8,["modelValue"]),i(z,{name:"fade"},{default:r(()=>[c.value.show?(p(),m("div",ye,[e("div",{class:P(["flex items-center justify-center w-8 h-8 rounded-full",c.value.type==="success"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[i(l(f),{name:c.value.type==="success"?"check":"alert-circle",class:"h-5 w-5"},null,8,["name"])],2),e("div",null,[e("h4",he,o(c.value.title),1),e("p",be,o(c.value.message),1)])])):S("",!0)]),_:1})]))}};var Ne=T(we,[["__scopeId","data-v-e010f9cc"]]);export{Ne as default};
